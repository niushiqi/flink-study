##腾讯看点的实时数据仓库和多维实时数据分析系统

1. 历史的架构是怎么样的？  
离线数据分析平台经过Spark的多层离线计算，输出到MySQL或者ES，过程3-6小时
通用大数据处理框架Kudu+Impala耗时耗时至少几分钟

1. 实时计算引擎，存储引擎的对比  
见图

1. 架构是怎么样的？  
消息队列 + 实时数据仓库 + 基于OLAP存储引擎 + APP层  
实时数据仓库：Lambda 架构，计算引擎使用Flink，存储引擎使用ClickHouse  
实时数仓：接入层（业务流量拆分，千万级/s -> 百万级/s）+ 计算层（关联用户画像和内容维度数据，1分钟的窗口聚合，redis缓存，1分钟数据数十秒完成关联）+ 存储层（DWM层，十万级/s，DWS层，万级/s）  
基于OLAP存储引擎：Hash路由（一分钟batch写入） + ClickHouse（ZK高可用分布式，磁盘分区N） + 高性能查询（稀疏索引，路由查询）  
扩容方案：实时存3天数据，新建集群  

1. 总体性能  
1分钟数据延迟，亚秒级响应多维条件查询请求，过去30分钟的查询，99%的请求耗时在1秒内；

